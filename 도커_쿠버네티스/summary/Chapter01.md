# 01. 도커의 기초

# 1-1. [**도커**](https://www.docker.com/)

**컨테이너형 가상화 기술을 구현**하기 위한 APP + CLI  

상주 앱(docker 데몬) + 이 앱을 조작하기 위한 명령행 도구(CLI)로 구성된 프로덕트

앱 배포에 특화돼 있어 앱 개발 및 운영을 컨테이너 중심

컨테이너: 도커가 만들어내는 게스트 운영 체제

도커의 장점(가상화 환경과 비교)
- 가볍게 동작
- 뛰어난 이식성
- 편리하게 환경을 구축
- 테스트와 운영 환경에서도 컨테이너 사용 가능

## 도커의 역사

컨테이너형 가상화 자체는 도커 이전에도 있던 기술

도커 이전에는 LXC(Linux Containers)가 유명

도커 런타임 도구는 초기에 `LXC`, 현재는 **`runC`** 

- 도커도 처음에 LCX를 사용(운영 체제 가상화)
- 0.9x, 리눅스 커널에서 컨테이너를 구현하는 namespaces나 cgroups등의 **API를 직접 실행**하는 `libcontainer` 라이브러리 개발
- 1.11 OCI(Open Container Initiative)를 구현한 runC를 런타임으로 사용

`dotCloud`사의 `솔로몬 하익스(Solomon Hykes)`가 최초로 도커를 오픈 소스로 공개

현재 도커는 컨테이너 관련 기술의 **사실상 표준** 지위

`오케스트레이션`: 도커 컨테이너를 각 **호스트 서버에 효율적으로 배치하기 위한 기술**

오케스트레이션 도구들
- `Fig`(현재 도커 컴포즈)
- `도커 스웜(DockerSwarm)`
- `쿠버네티스(Kubernetes)`
- `아파치 메소스(Apache Mesos)`

## 도커의 기본 개념

도커는 컨테이너형 가상화를 구현하기 위한 APP과 CLI로 구성

### 컨테이너형 가상화 기술

운영 체제 가상화 vs 컨테이너 가상화

컨테이너 가상화
- 가상화 소프트웨어 없이도 운영 체제의 리소스를 격리, 가상 운영 체제로 만들 수 있음
- 이 때 가상 운영 체제가 컨테이너
- 컨테이너를 만들면서 발생하는 오버헤드는 다른 가상화 소프트웨어보다 적음

운영 체제 가상화
- 운영 체제 위에서 가상화 소프트웨어를 사용해 하드웨어를 애뮬레이션 하는 방법
- 구조적으로 오버헤드가 더 큼

### 애플리케이션이 중심이 되는 도커

LXC는 호스트 운영 체제 가상화보다 성능 면에서 유리, **시스템 컨테이너**로서 어느 정도 자리를 잡음

`시스템 컨테이너`: 앱 배포 용도가 아닌 단순한 리소스 분리 목적

LXC의 단점: LXC에서 복제한 앱을 다른 LXC 호스트에서 실행핼 때 설정 차이로 동작 하지 않음

도커는 컨테이너가 갖는 성능적 이점을 살리면서 애플리케이션 배포에 초점

도커의 특징(vs LXC)
- 호스트 운영 체제의 영향을 받지 않는 실행 환경(Docker Engine을 이용한 실행 환경 표준화)
- 이미지 버전 관리
- DSL(Dockerfile)을 이용한 컨테이너 구성 및 앱 배포 정의
- 레이어 구조를 갖는 이미지 포맷(차분 빌드가 가능함)
- 도커 레지스트리(이미지 저장 서버 역할을 함)
- 프로그램 가능한 다양한 기능의 API

도커 컨테이너 정보를 `Dockerfile 코드`로 관리 가능

이 코드를 기반으로 복제 및 배포가 이루어저 **재현성이 높음**

만들어 둔 기존 컨테이너를 다른 환경에서 동작시키기 위한 메커니즘이 잘 갖춰짐

도커 이전 -> 호스트, 게스트 운영 체제에 배포, 이방식은 운영 체제의 영향을 강하게 받음

반면 도커는 **컨테이너에 애플리케이션 실행 환경이 함께 배포**되는 방식

아예 실행 환경째로 배포하는 방식의 **의존성 문제를 근본적으로 해결**

앱 배포본을 그냥 복사하는게 아닌가 싶을 정도로 간단히 컨테이너를 배포할 수 있는 장점도 있음

도커만 설치돼 있으면 CentOS에서 최적화 앱을 우분투 서버에 설치 가능

### 도커 스타일 체험

앱 생성 -> 도커 컨테이너에 담기 -> 도커 명령어로 컨테이너 실행

